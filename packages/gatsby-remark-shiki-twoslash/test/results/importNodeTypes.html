<h2>Imports node's type defs</h2>
<p>This has a global <code>process</code> and two imports</p>
<pre><code class="language-ts">/// &#x3C;reference types="node" />

// @ts-check
import fs from "fs"
import { execSync } from "child_process"

const fileToEdit = process.env.HUSKY_GIT_PARAMS!.split(" ")[0]
const files = execSync("git status --porcelain", { encoding: "utf8" })

const maps: any = {
  "spelltower/": "SPTWR",
  "typeshift/": "TPSFT",
}

const prefixes = new Set()
files.split("\n").forEach(f => {
  const found = Object.keys(maps).find(prefix => f.includes(prefix))
  if (found) prefixes.add(maps[found])
})

if (prefixes.size) {
  const prefix = [...prefixes.values()].sort().join(", ")
  const msg = fs.readFileSync(fileToEdit, "utf8")
  if (!msg.includes(prefix)) {
    fs.writeFileSync(fileToEdit, `[${prefix}] ${msg}`)
  }
}
</code></pre>

<style>
  .shiki {
    background-color: lightgrey;
    padding: 8px;
  }

  .error,
  .error-behind {
    margin-left: -20px;
    margin-right: -12px;
    margin-top: 4px;
    margin-bottom: 4px;
    padding: 6px;
    padding-left: 14px;

    white-space: pre-wrap;
    display: block;
  }

  .error {
    position: absolute;
    background-color: #ffeeee;
    border-left: 2px solid #bf1818;
    width: 100%;

    display: flex;
    align-items: center;
    color: black;
  }

  .error-behind {
    user-select: none;
    color: #ffeeee;
  }
  .query {
    color: white;
  }
</style>
